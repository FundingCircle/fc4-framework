#!/usr/bin/env bash
## Run this from the project root

# This script packages up the tool into a JAR file. That’s *almost* all we need to distribute, but
# in fact we have another script (pkg-all) that creates a .tar.gz file containing the JAR file, a
# README with installation instructions, and a shell script for launching the tool (so that users
# don’t have to invoke `java` directly but also to give us an opportunity to set some important Java
# system properties).

set -eu

# clojure automatically downloads deps if necessary. If this is running in CI,
# however, then hopefully the set of dependencies needed to build this uberjar
# have already been restored from a cache. See also ./download-pkg-deps
clojure -A:uberjar

target_dir="target/pkg"
mkdir -p $target_dir

target_path="$target_dir/fc4.jar"
mv target/fc4-SNAPSHOT-standalone.jar "$target_path"

echo "Successfully created $target_path"
