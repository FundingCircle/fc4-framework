#!/usr/bin/env bash
## Run this from <project-root>/tool/

# This script checks that all the required system deps are installed, and attempts to install those
# that are not.

set -eux

if [[ -z "$*" ]]; then
  echo 'ERROR: OS must be specified as first arg; see the source of this script for accepted values.'
  exit 1
fi

OS="$1"

case "$OS" in
'linux-arch')
  # We’re using sudo in /bin/install-clojure
  # We need tar so we can expand cached dependencies in our CI environment
  pacman --refresh --sync --needed --noconfirm --noprogressbar jre11-openjdk-headless chromium sudo tar

  # shellcheck disable=SC1091
  source /etc/profile.d/jre.sh
  ;;
'linux-debian')
  # Nothing to do here right now, because the Docker image that we’re using for this OS already has
  # everything that we need.
  ;;
'mac')
  echo 'TODO'
  ;;
*)
  echo "ERROR: '$1' is not a supported OS; see the source of this script for accepted values."
  exit 1
esac
